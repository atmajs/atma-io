import { File } from '../../src/File'
import { FileHooks } from '../../src/FileHooks'
import { Env } from '../../src/Env'

const handler = new FileHooks();
File.registerHookHandler(handler);

const importer = require('atma-io-middleware-importer');

importer.init({ File, env: Env });

// File.middleware['importer'] = importer;

handler.register(/./, 'read', 'atma-io-middleware-importer');

UTest({
    'read simple'() {

        var source = File.read('test/middleware/data/importer.js');

        has_(source, "'bar'");
        has_(source, "'a'");
        has_(source, "'b'");
    },

    'read with settings'() {
        let source = File.read('test/middleware/data/importer-settings.js');

        has_(source, "'a'");
        has_(source, "'b'");
        has_(source, "'c'");
    },
    'read exports file'() {
        var source = File
            .read('test/middleware/data/importer-exports.js');

        has_(source, "'a'");
        has_(source, "'b'");
    }
})
